---
const pathname = Astro.url.pathname
const isHomePage = pathname === '/' || pathname === ''
---

<header
  id="header"
  class:list={[
    'top-0 z-100 w-full bg-white/90 py-6 backdrop-blur-md transition-all duration-500',
    isHomePage ? 'fixed -translate-y-full opacity-0' : 'sticky',
  ]}
>
  <div
    class="mx-auto flex max-w-[1600px] items-center justify-between px-4 md:px-[5.5rem]"
  >
    <a
      href="/"
      class="font-serif text-2xl font-medium tracking-widest transition-colors hover:text-black"
      >TAICHI SAKAI</a
    >
    <nav class="flex gap-10">
      <a
        href="/"
        class="relative inline-block text-xs tracking-[0.2em] text-[var(--color-accent)] uppercase transition-colors after:absolute after:-bottom-1 after:left-0 after:h-[1px] after:w-full after:origin-left after:scale-x-0 after:bg-black after:transition-transform after:duration-300 after:ease-out hover:text-black hover:after:scale-x-100 md:text-sm"
        >Work</a
      >
      <a
        href="/about"
        class="relative inline-block text-xs tracking-[0.2em] text-[var(--color-accent)] uppercase transition-colors after:absolute after:-bottom-1 after:left-0 after:h-[1px] after:w-full after:origin-left after:scale-x-0 after:bg-black after:transition-transform after:duration-300 after:ease-out hover:text-black hover:after:scale-x-100 md:text-sm"
        >About</a
      >
      <a
        href="mailto:hello@example.com"
        class="relative inline-block text-xs tracking-[0.2em] text-[var(--color-accent)] uppercase transition-colors after:absolute after:-bottom-1 after:left-0 after:h-[1px] after:w-full after:origin-left after:scale-x-0 after:bg-black after:transition-transform after:duration-300 after:ease-out hover:text-black hover:after:scale-x-100 md:text-sm"
        >Contact</a
      >
    </nav>
  </div>
</header>

<script>
  document.addEventListener('astro:page-load', () => {
    const header = document.getElementById('header')
    const hero = document.getElementById('hero')

    if (header && hero) {
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (!entry.isIntersecting) {
              // Hero is out of view (scrolled past)
              header.classList.remove('opacity-0', '-translate-y-full')
            } else {
              // Hero is in view
              header.classList.add('opacity-0', '-translate-y-full')
            }
          })
        },
        {
          root: undefined,
          threshold: 0,
        }
      )

      observer.observe(hero)
    } else if (header) {
      header.classList.remove('opacity-0', '-translate-y-full')
    }
  })
</script>
