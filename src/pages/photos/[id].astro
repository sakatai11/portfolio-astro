---
import Layout from "@/layouts/Layout.astro";
import Detail from "@/components/sections/photos/Detail.astro";
import { getMicroCmsList, getMicroCmsDetail } from "@/libs/microcms";
import type { PhotosMain, PhotoDetail } from "@/types/index";

export async function getStaticPaths() {
  const photos = await getMicroCmsList<PhotosMain>({
    endpoint: 'photos',
    queries: { fields: ['id'] },
  });

  return photos.map((photo) => ({
    params: { id: photo.id },
  }));
}

const { id } = Astro.params;

const photoDetail: PhotoDetail = await getMicroCmsDetail<PhotoDetail>({
  endpoint: 'photos',
  contentId: id!,
});

---

<Layout title={photoDetail.title}>
  <Detail photoDetail={photoDetail} />
</Layout>
